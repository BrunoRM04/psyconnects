<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PsyConnects | Perfil</title>
    <link rel="stylesheet" href="../../public/css/styles.css">
    <link rel="shortcut icon" href="../../public/img/marca/icono.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>

    <header>
        <div class="logo"> 
            <img src="../../public/img/marca/logo cuatro.png" alt="Logo">
        </div>
        <nav>
            <ul class="nav-links">
                <li><a href="../../index.html">Inicio</a></li>
                <li><a href="../../psicologos.html">Psicólogos Disponibles</a></li>
                <li><a href="../../investigacion.html">Investigaciones</a></li>
                <li><a href="../../test.html">Test Práctico</a></li>
                <li><a href="../../ofertas.html">Ofertas Laborales</a></li>
                <li><a href="https://forms.gle/XNqhQksUqjXX6B4p7">Registrarse</a></li>
            </ul>
            <ul class="nav-icons">
                <li><a href="../../index.html"><i class="fas fa-home"></i></a></li>
                <li><a href="../../psicologos.html"><i class="fas fa-user-md"></i></a></li>
                <li><a href="../../investigacion.html"><i class="fas fa-book"></i></a></li>
                <li><a href="../../test.html"><i class="fas fa-pencil-alt"></i></a></li>
                <li><a href="../../ofertas.html"><i class="fas fa-briefcase"></i></a></li>
                <li><a href="https://forms.gle/XNqhQksUqjXX6B4p7"><i class="fas fa-user-plus"></i></a></li>
            </ul>
        </nav> 
    </header>

    <main>

        <div class="perfil-container">
            <div class="perfil-info">
                <h2 id="nombre"></h2>
                <div class="detalles-container">
                    <div class="detalles-inline">
                        <div class="detalles" id="edad"></div>
                        <div class="detalles" id="pais"></div>
                        <div class="detalles" id="fechaNacimiento"></div>
                    </div>
                    <div class="detalles" id="correoElectronico"></div>
                    <a class="detalles" id="telefono" href="#"></a>
                    <div class="detalles" id="añosExperiencia"></div>
                    <div class="detalles" id="idiomas"></div>
                    <div class="detalles" id="precioServicioHora"></div>
                </div>
                <button id="reservar-cita" class="reservar-btn">Reservar Cita ></button>
                <div class="redes-sociales">
                    <a id="linkedin" href="#" target="_blank"><i class="fab fa-linkedin"></i></a>
                    <a id="facebook" href="#" target="_blank"><i class="fab fa-facebook"></i></a>
                    <a id="twitter" href="#" target="_blank"><i class="fab fa-twitter"></i></a>
                    <a id="instagram" href="#" target="_blank"><i class="fab fa-instagram"></i></a>
                    <a id="youtube" href="#" target="_blank"><i class="fab fa-youtube"></i></a>
                    <a id="whatsapp" href="#" target="_blank"><i class="fab fa-whatsapp"></i></a>
                    <a id="tiktok" href="#" target="_blank"><i class="fab fa-tiktok"></i></a>
                    <a id="snapchat" href="#" target="_blank"><i class="fab fa-snapchat"></i></a>
                </div>
            </div>
            <div class="perfil-descripcion">
                <h3>Descripción</h3>
                <p id="descripcion"></p>
                <h3>Experiencia</h3>
                <ul id="experiencia"></ul>
                <h3>Certificaciones</h3>
                <ul id="certificaciones"></ul>
            </div>
        </div>
        <div class="comentarios-container">
            <div class="comentarios-inner">
                <h3 class="comentarios-titulo">Valoración De Psicólogo/a</h3>
                <form id="commentForm" class="comentarios-form">
                    <input type="text" id="name" class="comentarios-input" placeholder="Nombre" required>
                    <input type="text" id="country" class="comentarios-input" placeholder="País" required>
                    <textarea id="comment" class="comentarios-textarea" placeholder="Comentario" required></textarea>
                    <button type="submit" class="comentarios-boton">Valorar ></button>
                </form>
                <div id="commentsContainer" class="comentarios-lista"></div>
            </div>
        </div>

    </main>

    <footer>
        <div class="footer-container">
            <div class="footer-nav">
                <a href="#">EMPRESAS</a>
                <a href="https://forms.gle/xZERw5gE8yzQELDc8">REGISTRARSE</a>
                <a href="../../doc/pdf/TÉRMINOS Y CONDICIONES - PSYCONNECTS.pdf">TÉRMINOS Y CONDICIONES</a>
                <a href="#">QUIENES SOMOS</a>
            </div>
            <div class="footer-social">
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Todos Los Derechos Reservados 2024 | @PsyConnects</p>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const psicologoId = parseInt(urlParams.get('id'), 10);
    
            fetch('../../json/psicologos.json')
            .then(response => response.json())
            .then(data => {
                const psicologo = data.psicologos.find(psic => psic.id === psicologoId);
    
                if (psicologo) {
                    document.getElementById('nombre').textContent = `${psicologo.nombre} ${psicologo.apellido}`;
                    document.getElementById('edad').textContent = `${calcularEdad(psicologo.fechaNacimiento)} Años`;
                    document.getElementById('pais').textContent = psicologo.pais;
                    document.getElementById('fechaNacimiento').textContent = psicologo.fechaNacimiento;
                    document.getElementById('correoElectronico').textContent = psicologo.correoElectronico;
    
                    const telefonoElement = document.getElementById('telefono');
                    telefonoElement.textContent = psicologo.telefono;
                    telefonoElement.href = `https://wa.me/${psicologo.telefono.replace(/[^0-9]/g, '')}?text=Buenas,%20encontré%20su%20perfil%20en%20PsyConnects.`;
    
                    document.getElementById('añosExperiencia').textContent = `${psicologo.añosExperiencia} años de experiencia`;
                    document.getElementById('idiomas').textContent = psicologo.idiomas.join(' - ');
                    document.getElementById('precioServicioHora').textContent = `${psicologo.precioServicioHora} USD x Hora`;
                    document.getElementById('descripcion').textContent = psicologo.descripcion;
    
                    const experienciaList = document.getElementById('experiencia');
                    psicologo.experiencia.forEach(exp => {
                        const li = document.createElement('li');
                        li.textContent = `${exp.puesto} en ${exp.institucion} (${exp.añoInicio}-${exp.añoFin})`;
                        experienciaList.appendChild(li);
                    });
    
                    const certificacionesList = document.getElementById('certificaciones');
                    psicologo.certificaciones.forEach(cert => {
                        const li = document.createElement('li');
                        li.textContent = `${cert.nombre} - ${cert.institucion} (${cert.año})`;
                        certificacionesList.appendChild(li);
                    });
    
                    const linkedinElement = document.getElementById('linkedin');
                    if (psicologo.redesSociales.linkedin) {
                        linkedinElement.href = psicologo.redesSociales.linkedin;
                    } else {
                        linkedinElement.style.display = 'none';
                    }
    
                    const facebookElement = document.getElementById('facebook');
                    if (psicologo.redesSociales.facebook) {
                        facebookElement.href = psicologo.redesSociales.facebook;
                    } else {
                        facebookElement.style.display = 'none';
                    }
    
                    const twitterElement = document.getElementById('twitter');
                    if (psicologo.redesSociales.twitter) {
                        twitterElement.href = psicologo.redesSociales.twitter;
                    } else {
                        twitterElement.style.display = 'none';
                    }
    
                    const instagramElement = document.getElementById('instagram');
                    if (psicologo.redesSociales.instagram) {
                        instagramElement.href = psicologo.redesSociales.instagram;
                    } else {
                        instagramElement.style.display = 'none';
                    }
    
                    const youtubeElement = document.getElementById('youtube');
                    if (psicologo.redesSociales.youtube) {
                        youtubeElement.href = psicologo.redesSociales.youtube;
                    } else {
                        youtubeElement.style.display = 'none';
                    }
    
                    const whatsappElement = document.getElementById('whatsapp');
                    if (psicologo.redesSociales.whatsapp) {
                        whatsappElement.href = `https://wa.me/${psicologo.redesSociales.whatsapp.replace(/[^0-9]/g, '')}?text=Buenas,%20encontré%20su%20perfil%20en%20PsyConnects.`;
                    } else {
                        whatsappElement.style.display = 'none';
                    }
    
                    const tiktokElement = document.getElementById('tiktok');
                    if (psicologo.redesSociales.tiktok) {
                        tiktokElement.href = psicologo.redesSociales.tiktok;
                    } else {
                        tiktokElement.style.display = 'none';
                    }
    
                    const snapchatElement = document.getElementById('snapchat');
                    if (psicologo.redesSociales.snapchat) {
                        snapchatElement.href = psicologo.redesSociales.snapchat;
                    } else {
                        snapchatElement.style.display = 'none';
                    }
    
                    // Botón de reservar cita
                    const reservarCitaBtn = document.getElementById('reservar-cita');
                    reservarCitaBtn.addEventListener('click', function() {
                        const mensajeWhatsApp = `https://wa.me/${psicologo.telefono.replace(/[^0-9]/g, '')}?text=Buenas,%20encontré%20su%20perfil%20en%20PsyConnects.%20Me%20gustaría%20reservar%20una%20cita.`;
                        window.location.href = mensajeWhatsApp;
                    });
                } else {
                    alert('Psicólogo no encontrado');
                }
            });
    
            function calcularEdad(fechaNacimiento) {
                const hoy = new Date();
                const fechaNac = new Date(fechaNacimiento);
                let edad = hoy.getFullYear() - fechaNac.getFullYear();
                const mes = hoy.getMonth() - fechaNac.getMonth();
                if (mes < 0 || (mes === 0 && hoy.getDate() < fechaNac.getDate())) {
                    edad--;
                }
                return edad;
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        const psicologoId = urlParams.get('id');
        const commentForm = document.getElementById('commentForm');
        const commentsContainer = document.getElementById('commentsContainer');
        const secretCode = 'PSYCONNECTS DELETE';

        loadComments(psicologoId);

        commentForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const country = document.getElementById('country').value;
            const comment = document.getElementById('comment').value;

            if (name && country && comment) {
                addComment(psicologoId, name, country, comment);
                commentForm.reset();
            }
        });

        commentsContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('comentarios-eliminar-boton')) {
                const commentElement = e.target.parentElement;
                const code = prompt('Ingresa el código secreto para eliminar este comentario:');

                if (code === secretCode) {
                    commentElement.remove();
                    saveComments(psicologoId);
                } else {
                    alert('Código incorrecto.');
                }
            }
        });

        function addComment(psicologoId, name, country, comment) {
            const commentElement = document.createElement('div');
            commentElement.classList.add('comentarios-item');
            commentElement.innerHTML = `
                <div class="comentarios-avatar">${name.charAt(0)}</div>
                <div class="comentarios-contenido">
                    <p class="comentarios-autor">${name}</p>
                    <p class="comentarios-pais">${country}</p>
                    <p class="comentarios-texto">${comment}</p>
                </div>
                <button class="comentarios-eliminar-boton">&times;</button>
            `;
            commentsContainer.appendChild(commentElement);
            saveComments(psicologoId);
        }

        function saveComments(psicologoId) {
            const comments = [];
            document.querySelectorAll('.comentarios-item').forEach(commentElement => {
                const name = commentElement.querySelector('.comentarios-autor').innerText;
                const country = commentElement.querySelector('.comentarios-pais').innerText;
                const comment = commentElement.querySelector('.comentarios-texto').innerText;
                comments.push({ name, country, comment });
            });
            localStorage.setItem(`comments_${psicologoId}`, JSON.stringify(comments));
        }

        function loadComments(psicologoId) {
            const comments = JSON.parse(localStorage.getItem(`comments_${psicologoId}`)) || [];
            comments.forEach(({ name, country, comment }) => addComment(psicologoId, name, country, comment));
        }
    });
    </script>

</body>
</html>

