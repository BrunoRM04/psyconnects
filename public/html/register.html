<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PsyConnects | Registrarse</title>
    <link rel="stylesheet" href="../../public/css/styles.css">
    <link rel="shortcut icon" href="../../public/img/marca/icono.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>

    <header>

        <div class="logo">
            <img src="../../public/img/marca/icono 2.png" alt="Logo">
        </div>
        <div class="menu-toggle">
            <i class="fas fa-bars"></i>
        </div>
        <nav class="nav-menu">
            <div class="close-menu">
                <i class="fas fa-times"></i>
            </div>
            <ul class="nav-links">
                <li><a href="../../index.html">ğŸ  Inicio</a></li>
                <li><a href="../../psicologos.html">ğŸ§  PsicÃ³logos Disponibles</a></li>
                <li><a href="../../investigaciones.html">ğŸ“¡ Investigaciones</a></li>
                <li><a href="../../ofertas.html">ğŸ’¼ Ofertas Laborales</a></li>
                <li><a href="../../login.html">ğŸ‘¤ Mi Cuenta</a></li>
                <li><a href="register.html">ğŸ†• Registrarse</a></li>
            </ul>
        </nav>

    </header>

    <div id="bienvenida-overlay" class="bienvenida-overlay">
        <div class="bienvenida-contenido">
            <h1 id="mensaje-bienvenida">Â¡Bienvenid@ a PsyConnects!</h1>
            <p class="mensaje-espera">Espere unos segundos mientras creamos su perfil.</p>
        </div>
    </div>

    <div class="registro-header">
        <h1 class="registro-header-titulo">Â¡RegÃ­strate como psicÃ³logo/a aquÃ­! ğŸ¤©</h1>
        <p class="registro-header-descripcion">Una vez registrado, tendrÃ¡s acceso a las siguientes acciones:</p>
        <ul class="registro-lista">
            <li>ğŸ‘‰ Perfil personal con acceso libre.</li>
            <li>ğŸ‘‰ Edita tu perfil cuando lo desees.</li>
            <li>ğŸ‘‰ Datos de visitas al perfil y de quÃ© paÃ­s provienen.</li>
            <li>ğŸ‘‰ Crea tu calendario marcando los dÃ­as y horas que estÃ¡s disponible.</li>
            <li>ğŸ‘‰ Acceso gratuito a cualquier taller, actividad, charlas, que realice PsyConnects.</li>
        </ul>
    </div>

    <main class="principal-registro">

        <div class="contenedor-registro">
            <div class="imagen-columna">
                <img src="../../public/img/banner/banner-register.png" alt="Imagen Formulario" loading="lazy">
            </div>
            <div class="formulario-columna">
                <h2 class="titulo-registro">Â¡Ãšnete a PsyConnects! ğŸ“</h2>
                <div class="barra-progreso">
                    <div class="paso-conector">
                        <div class="paso activo" data-titulo="Personal">ğŸ‘¤</div>
                        <div class="linea"></div>
                    </div>
                    <div class="paso-conector">
                        <div class="paso" data-titulo="Contacto">ğŸ“</div>
                        <div class="linea"></div>
                    </div>
                    <div class="paso-conector">
                        <div class="paso" data-titulo="Profesional">ğŸ’¼</div>
                        <div class="linea"></div>
                    </div>
                    <div class="paso-conector">
                        <div class="paso" data-titulo="Especialidades">ğŸ©º</div>
                        <div class="linea"></div>
                    </div>
                    <div class="paso-conector">
                        <div class="paso" data-titulo="Servicios">ğŸ›ï¸</div>
                    </div>
                </div>

                <form id="formularioRegistro" class="formulario-registro" enctype="multipart/form-data">
                    <div class="paso-formulario activo">
                        <div class="grupo-formulario">
                            <label for="nombre" class="etiqueta-formulario">Nombre ğŸ‘‡</label>
                            <input type="text" id="nombre" required>
                        </div>

                        <div class="grupo-formulario">
                            <label for="apellido" class="etiqueta-formulario">Apellido ğŸ‘‡</label>
                            <input type="text" id="apellido" required>
                        </div>

                        <div class="grupo-formulario">
                            <label for="documento" class="etiqueta-formulario">NÂ° de Documento ğŸ“„</label>
                            <input type="text" id="documento">
                        </div>

                        <div class="grupo-formulario">
                            <label for="correoElectronico" class="etiqueta-formulario">Correo ElectrÃ³nico ğŸ“§</label>
                            <input type="email" id="correoElectronico" required>
                        </div>

                        <div class="grupo-formulario">
                            <label for="contraseÃ±a" class="etiqueta-formulario">ContraseÃ±a ğŸ”’</label>
                            <div style="position: relative;">
                                <input type="password" id="contraseÃ±a" required minlength="6">
                                <button type="button" id="toggle-contraseÃ±a"
                                    style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer;">
                                    ğŸ‘ï¸
                                </button>
                            </div>
                        </div>

                        <div class="botones-navegacion">
                            <button type="button" class="btn-formulario boton-siguiente">Siguiente â¡ï¸</button>
                        </div>
                    </div>

                    <div class="paso-formulario">

                        <div class="grupo-formulario">
                            <label for="fechaNacimiento" class="etiqueta-formulario">Fecha de Nacimiento ğŸ‚</label>
                            <input type="date" id="fechaNacimiento" required>
                        </div>

                        <div class="grupo-formulario">
                            <label for="pais" class="etiqueta-formulario">PaÃ­s ğŸŒ</label>
                            <select id="pais" required>
                                <option value="" disabled selected>Selecciona tu paÃ­s</option>
                                <option value="Argentina">Argentina</option>
                                <option value="Bolivia">Bolivia</option>
                                <option value="Brasil">Brasil</option>
                                <option value="Chile">Chile</option>
                                <option value="Colombia">Colombia</option>
                                <option value="Costa Rica">Costa Rica</option>
                                <option value="Cuba">Cuba</option>
                                <option value="Ecuador">Ecuador</option>
                                <option value="El Salvador">El Salvador</option>
                                <option value="EspaÃ±a">EspaÃ±a</option>
                                <option value="Guatemala">Guatemala</option>
                                <option value="Honduras">Honduras</option>
                                <option value="MÃ©xico">MÃ©xico</option>
                                <option value="Nicaragua">Nicaragua</option>
                                <option value="PanamÃ¡">PanamÃ¡</option>
                                <option value="Paraguay">Paraguay</option>
                                <option value="PerÃº">PerÃº</option>
                                <option value="Puerto Rico">Puerto Rico</option>
                                <option value="RepÃºblica Dominicana">RepÃºblica Dominicana</option>
                                <option value="Uruguay">Uruguay</option>
                                <option value="Venezuela">Venezuela</option>
                            </select>
                        </div>

                        <div class="grupo-formulario">
                            <label for="telefono" class="etiqueta-formulario">TelÃ©fono (Con CÃ³digo de PaÃ­s) ğŸ“±</label>
                            <input type="tel" id="telefono" required>
                        </div>

                        <div class="botones-navegacion">
                            <button type="button" class="btn-formulario boton-anterior">â¬…ï¸ Anterior</button>
                            <button type="button" class="btn-formulario boton-siguiente">Siguiente â¡ï¸</button>
                        </div>
                    </div>

                    <div class="paso-formulario">
                        <div class="grupo-formulario">
                            <label for="aÃ±osExperiencia" class="etiqueta-formulario">AÃ±os de Experiencia ğŸ—“ï¸</label>
                            <input type="number" id="aÃ±osExperiencia" required min="0">
                        </div>

                        <div class="grupo-formulario">
                            <label for="fotoPerfil" class="etiqueta-formulario">Foto de Perfil ğŸ“·</label>
                            <input type="file" id="fotoPerfil" accept="image/*" required>
                        </div>

                        <div class="grupo-formulario">
                            <label for="descripcion" class="etiqueta-formulario">DescripciÃ³n ğŸ“</label>
                            <textarea id="descripcion" required></textarea>
                        </div>

                        <div class="grupo-formulario">
                            <label class="etiqueta-formulario">Experiencia Profesional ğŸ¢</label>
                            <div id="contenedor-experiencia"></div>
                            <button type="button" id="agregar-experiencia" class="btn-formulario">Agregar Experiencia
                                â•</button>
                        </div>

                        <div class="grupo-formulario">
                            <label class="etiqueta-formulario">Certificaciones ğŸ“‘</label>
                            <div id="contenedor-certificaciones"></div>
                            <button type="button" id="agregar-certificacion" class="btn-formulario">Agregar
                                CertificaciÃ³n â•</button>
                        </div>

                        <div class="grupo-formulario">
                            <label for="precioServicioHora" class="etiqueta-formulario">Precio por Hora (USD) ğŸ’²</label>
                            <input type="number" id="precioServicioHora" required min="0" step="0.01">
                        </div>

                        <div class="botones-navegacion">
                            <button type="button" class="btn-formulario boton-anterior">â¬…ï¸ Anterior</button>
                            <button type="button" class="btn-formulario boton-siguiente">Siguiente â¡ï¸</button>
                        </div>
                    </div>

                    <div class="paso-formulario">
                        <div class="grupo-formulario">
                            <label class="etiqueta-formulario">Tipos de Terapia ğŸ§  (Seleccionar 3 tipos)</label>
                            <div class="grupo-botones">
                                <button type="button" class="boton-opcion" data-valor="Terapia Cognitivo-Conductual">ğŸ§ 
                                    Terapia Cognitivo-Conductual</button>
                                <button type="button" class="boton-opcion" data-valor="Terapia Humanista">ğŸ’— Terapia
                                    Humanista</button>
                                <button type="button" class="boton-opcion" data-valor="Terapia PsicoanalÃ­tica">ğŸ›‹ï¸
                                    Terapia PsicoanalÃ­tica</button>
                                <button type="button" class="boton-opcion" data-valor="Terapia Gestalt">ğŸŒˆ Terapia
                                    Gestalt</button>
                                <button type="button" class="boton-opcion"
                                    data-valor="Terapia de AceptaciÃ³n y Compromiso">ğŸ¤ Terapia de AceptaciÃ³n y
                                    Compromiso</button>
                                <button type="button" class="boton-opcion" data-valor="Terapia Familiar">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦
                                    Terapia Familiar</button>
                                <button type="button" class="boton-opcion" data-valor="Terapia de Pareja">â¤ï¸ Terapia de
                                    Pareja</button>
                                <button type="button" class="boton-opcion" data-valor="Terapia de Juego">ğŸ² Terapia de
                                    Juego</button>
                                <button type="button" class="boton-opcion" data-valor="Terapia EMDR">ğŸ‘ï¸ Terapia
                                    EMDR</button>
                            </div>
                        </div>

                        <div class="grupo-formulario">
                            <label class="etiqueta-formulario">Idiomas ğŸ—£ï¸</label>
                            <div class="grupo-botones">
                                <button type="button" class="boton-opcion" data-valor="EspaÃ±ol">ğŸ‡ªğŸ‡¸ EspaÃ±ol</button>
                                <button type="button" class="boton-opcion" data-valor="InglÃ©s">ğŸ‡¬ğŸ‡§ InglÃ©s</button>
                                <button type="button" class="boton-opcion" data-valor="PortuguÃ©s">ğŸ‡µğŸ‡¹
                                    PortuguÃ©s</button>
                                <button type="button" class="boton-opcion" data-valor="FrancÃ©s">ğŸ‡«ğŸ‡· FrancÃ©s</button>
                                <button type="button" class="boton-opcion" data-valor="Italiano">ğŸ‡®ğŸ‡¹ Italiano</button>
                                <button type="button" class="boton-opcion" data-valor="AlemÃ¡n">ğŸ‡©ğŸ‡ª AlemÃ¡n</button>
                                <button type="button" class="boton-opcion" data-valor="Chino">ğŸ‡¨ğŸ‡³ Chino</button>
                                <button type="button" class="boton-opcion" data-valor="JaponÃ©s">ğŸ‡¯ğŸ‡µ JaponÃ©s</button>
                                <button type="button" class="boton-opcion" data-valor="Ãrabe">ğŸ‡¸ğŸ‡¦ Ãrabe</button>
                            </div>
                        </div>

                        <div class="botones-navegacion">
                            <button type="button" class="btn-formulario boton-anterior">â¬…ï¸ Anterior</button>
                            <button type="button" class="btn-formulario boton-siguiente">Siguiente â¡ï¸</button>
                        </div>
                    </div>

                    <div class="paso-formulario">

                        <div class="grupo-formulario">
                            <label class="etiqueta-formulario">Redes Sociales ğŸŒ</label>
                            <div class="grupo-redes-sociales">
                                <div class="item-red-social">
                                    <i class="fab fa-instagram"></i>
                                    <input type="url" id="instagram" placeholder="https://www.instagram.com/@tuusuario">
                                </div>
                                <div class="item-red-social">
                                    <i class="fab fa-facebook"></i>
                                    <input type="url" id="facebook" placeholder="https://www.facebook.com/@tuusuario">
                                </div>
                                <div class="item-red-social">
                                    <i class="fab fa-linkedin"></i>
                                    <input type="url" id="linkedin" placeholder="https://www.linkedin.com/@tuusuario">
                                </div>
                                <div class="item-red-social">
                                    <i class="fab fa-tiktok"></i>
                                    <input type="url" id="tiktok" placeholder="https://www.tiktok.com/@tuusuario">
                                </div>
                            </div>
                        </div>

                        <div class="botones-navegacion">
                            <button type="button" class="btn-formulario boton-anterior">â¬…ï¸ Anterior</button>
                            <button type="submit" class="btn-formulario boton-envio">Registrar âœ…</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <div class="terminos-psyc">
        <h3 class="titulo-terminos">TÃ©rminos Y Condiciones De PsyConnects</h3>
        <p class="contenido-terminos">
            Al registrarte en <span style="font-weight: bold;">PsyConnects</span>, aceptas nuestros <span style="font-weight: bold;">tÃ©rminos y condiciones</span>. 
            <span style="font-weight: bold;">Para completar tu registro</span>, es necesario contar con una <span style="font-weight: bold;">cuenta PayPal vÃ¡lida</span> o 
            residir en un territorio que acepte <span style="font-weight: bold;">transferencias a travÃ©s de PayPal</span>. 
            Este acuerdo incluye, pero no se limita a, el <span style="font-weight: bold;">uso responsable de la plataforma</span>, el 
            <span style="font-weight: bold;">respeto a la privacidad de otros usuarios</span> y el <span style="font-weight: bold;">cumplimiento de las leyes aplicables</span>. 
            <span style="font-weight: bold;">Cada vez que se realiza una reserva</span> a travÃ©s de PsyConnects, la plataforma retiene un 
            <span style="font-weight: bold;">12% del total de la sesiÃ³n</span> como comisiÃ³n por el uso de nuestros servicios. 
            La informaciÃ³n proporcionada serÃ¡ tratada de acuerdo con nuestra <span style="font-weight: bold;">polÃ­tica de privacidad</span>. 
            <span style="font-weight: bold;">PsyConnects no se hace responsable</span> de las acciones fuera de la plataforma. 
            Es tu responsabilidad <span style="font-weight: bold;">verificar la autenticidad de los servicios ofrecidos por terceros</span>. 
            AdemÃ¡s, te comprometes a <span style="font-weight: bold;">mantener la confidencialidad de tus credenciales de acceso</span> y a 
            <span style="font-weight: bold;">notificar cualquier uso no autorizado de tu cuenta</span>.</a>.
        </p>
    </div>

    <footer>

        <div class="footer-container">
            <div class="footer-nav">
                <a href="#">EMPRESAS</a>
                <a href="#">REGISTRARSE</a>
                <a href="../../doc/pdf/TÃ‰RMINOS Y CONDICIONES - PSYCONNECTS.pdf">TÃ‰RMINOS Y CONDICIONES</a>
                <a href="#">QUIENES SOMOS</a>
            </div>
            <div class="footer-social">
                <a href="https://www.instagram.com/psyconnects/"><i class="fab fa-instagram"></i></a>
                <a href="https://www.facebook.com/profile.php?id=61564496164581"><i class="fab fa-facebook"></i></a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Todos Los Derechos Reservados 2024 | @PsyConnects</p>
        </div>
        
    </footer>

    <script type="module">

        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
        import { getFirestore, setDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";
        import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-storage.js";
        import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA3YzDZbNdjZJL5siTvV9N2n1-z_tI5BvQ",
            authDomain: "psyconnects-7be13.firebaseapp.com",
            projectId: "psyconnects-7be13",
            storageBucket: "psyconnects-7be13.appspot.com",
            messagingSenderId: "299531221809",
            appId: "1:299531221809:web:c6bba4831be2d70d910e10",
            measurementId: "G-FKC5P4PE6V"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const auth = getAuth(app);

        document.addEventListener('DOMContentLoaded', function () {
            function agregarEntradaExperiencia(exp = {}, index) {
                const contenedor = document.getElementById('contenedor-experiencia');
                const div = document.createElement('div');
                div.classList.add('entrada-dinamica', 'experiencia-entry');
                div.innerHTML = `
                        <div class="grupo-formulario">
                            <label for="experiencia-puesto-${index}" class="etiqueta-formulario">Puesto:</label>
                            <input type="text" class="experiencia-puesto" id="experiencia-puesto-${index}" value="${exp.puesto || ''}" required>
                        </div>
                        <div class="grupo-formulario">
                            <label for="experiencia-institucion-${index}" class="etiqueta-formulario">InstituciÃ³n:</label>
                            <input type="text" class="experiencia-institucion" id="experiencia-institucion-${index}" value="${exp.institucion || ''}" required>
                        </div>
                        <div class="grupo-formulario">
                            <label for="experiencia-aÃ±oInicio-${index}" class="etiqueta-formulario">AÃ±o de Inicio:</label>
                            <input type="number" class="experiencia-aÃ±oInicio" id="experiencia-aÃ±oInicio-${index}" value="${exp.aÃ±oInicio || ''}" required min="1900" max="2100">
                        </div>
                        <div class="grupo-formulario">
                            <label for="experiencia-aÃ±oFin-${index}" class="etiqueta-formulario">AÃ±o de Fin:</label>
                            <input type="number" class="experiencia-aÃ±oFin" id="experiencia-aÃ±oFin-${index}" value="${exp.aÃ±oFin || ''}" ${exp.actualidad ? 'disabled' : ''} min="1900" max="2100">
                        </div>
                        <div class="grupo-formulario">
                            <label for="experiencia-actualidad-${index}" class="etiqueta-formulario">Actualidad:</label>
                            <input type="checkbox" class="experiencia-actualidad" id="experiencia-actualidad-${index}" ${exp.actualidad ? 'checked' : ''}>
                        </div>
                        <button type="button" class="boton-eliminar">Ã—</button>
                    `;
                contenedor.appendChild(div);

                const checkbox = div.querySelector(`#experiencia-actualidad-${index}`);
                const aÃ±oFinInput = div.querySelector(`#experiencia-aÃ±oFin-${index}`);

                checkbox.addEventListener('change', function () {
                    aÃ±oFinInput.disabled = this.checked;
                    if (this.checked) aÃ±oFinInput.value = '';
                });

                div.querySelector('.boton-eliminar').addEventListener('click', () => div.remove());
            }

            function agregarEntradaCertificacion(cert = {}, index) {
                const contenedor = document.getElementById('contenedor-certificaciones');
                const div = document.createElement('div');
                div.classList.add('entrada-dinamica', 'certificacion-entry');
                div.innerHTML = `
                        <div class="grupo-formulario">
                            <label for="certificacion-nombre-${index}" class="etiqueta-formulario">Nombre de CertificaciÃ³n:</label>
                            <input type="text" class="certificacion-nombre" id="certificacion-nombre-${index}" value="${cert.nombre || ''}" required>
                        </div>
                        <div class="grupo-formulario">
                            <label for="certificacion-institucion-${index}" class="etiqueta-formulario">InstituciÃ³n:</label>
                            <input type="text" class="certificacion-institucion" id="certificacion-institucion-${index}" value="${cert.institucion || ''}" required>
                        </div>
                        <div class="grupo-formulario">
                            <label for="certificacion-aÃ±o-${index}" class="etiqueta-formulario">AÃ±o:</label>
                            <input type="number" class="certificacion-aÃ±o" id="certificacion-aÃ±o-${index}" value="${cert.aÃ±o || ''}" required min="1900" max="2100">
                        </div>
                        <button type="button" class="boton-eliminar">Ã—</button>
                    `;
                contenedor.appendChild(div);

                div.querySelector('.boton-eliminar').addEventListener('click', () => div.remove());
            }

            const botonesOpcion = document.querySelectorAll('.boton-opcion');
            botonesOpcion.forEach(boton => {
                boton.addEventListener('click', () => {
                    boton.classList.toggle('activo');

                    const grupoFormulario = boton.closest('.grupo-formulario');
                    const label = grupoFormulario.querySelector('label');
                    if (label && label.textContent.includes("Tipos de Terapia")) {
                        const seleccionados = Array.from(grupoFormulario.querySelectorAll('.boton-opcion.activo'));
                        if (seleccionados.length > 3) {
                            boton.classList.remove('activo');
                            alert('Solo puedes seleccionar hasta 3 tipos de terapia.');
                        }
                    }
                });
            });

            document.getElementById('agregar-experiencia').addEventListener('click', () => {
                const index = document.querySelectorAll('.experiencia-entry').length + 1;
                agregarEntradaExperiencia({}, index);
            });

            document.getElementById('agregar-certificacion').addEventListener('click', () => {
                const index = document.querySelectorAll('.certificacion-entry').length + 1;
                agregarEntradaCertificacion({}, index);
            });

            document.getElementById('formularioRegistro').addEventListener('submit', async function (event) {
                event.preventDefault();

                const nombre = document.getElementById('nombre').value.trim();
                const apellido = document.getElementById('apellido').value.trim();
                const documento = document.getElementById('documento').value.trim(); // Nuevo campo capturado
                const pais = document.getElementById('pais').value;
                const correoElectronico = document.getElementById('correoElectronico').value.trim();
                const telefono = document.getElementById('telefono').value.trim();
                const aÃ±osExperiencia = document.getElementById('aÃ±osExperiencia').value;
                const precioServicioHora = document.getElementById('precioServicioHora').value;
                const descripcion = document.getElementById('descripcion').value.trim();
                const fechaNacimiento = document.getElementById('fechaNacimiento').value;
                const contraseÃ±a = document.getElementById('contraseÃ±a').value;

                const instagram = document.getElementById('instagram').value.trim() || null;
                const facebook = document.getElementById('facebook').value.trim() || null;
                const linkedin = document.getElementById('linkedin').value.trim() || null;
                const tiktok = document.getElementById('tiktok').value.trim() || null;

                let tiposTerapia = [];
                let idiomas = [];

                const gruposFormulario = document.querySelectorAll('#formularioRegistro .grupo-formulario');
                gruposFormulario.forEach(grupo => {
                    const label = grupo.querySelector('label');
                    if (label) {
                        if (label.textContent.includes('Tipos de Terapia')) {
                            tiposTerapia = Array.from(grupo.querySelectorAll('.boton-opcion.activo')).map(btn => btn.dataset.valor);
                        }
                        if (label.textContent.includes('Idiomas')) {
                            idiomas = Array.from(grupo.querySelectorAll('.boton-opcion.activo')).map(btn => btn.dataset.valor);
                        }
                    }
                });

                if (tiposTerapia.length > 3) {
                    alert('Solo puedes seleccionar hasta 3 tipos de terapia.');
                    return;
                }

                const fotoPerfilInput = document.getElementById('fotoPerfil').files[0];
                if (!fotoPerfilInput) {
                    alert("Por favor, sube una imagen de perfil.");
                    return;
                }

                try {
                    const userCredential = await createUserWithEmailAndPassword(auth, correoElectronico, contraseÃ±a);
                    const user = userCredential.user;
                    const psicologoId = user.uid;

                    const storageRef = ref(storage, `perfil_fotos/${psicologoId}`);
                    const uploadTask = uploadBytesResumable(storageRef, fotoPerfilInput);

                    uploadTask.on('state_changed',
                        null,
                        (error) => {
                            console.error("Error al subir la imagen: ", error);
                            alert("Hubo un error al subir la imagen de perfil. Por favor, intenta de nuevo.");
                        },
                        async () => {
                            const fotoPerfilUrl = await getDownloadURL(uploadTask.snapshot.ref);

                            const experiencia = Array.from(document.querySelectorAll('.experiencia-entry')).map(entry => ({
                                puesto: entry.querySelector('.experiencia-puesto').value.trim(),
                                institucion: entry.querySelector('.experiencia-institucion').value.trim(),
                                aÃ±oInicio: entry.querySelector('.experiencia-aÃ±oInicio').value,
                                aÃ±oFin: entry.querySelector('.experiencia-actualidad').checked ? 'Actualidad' : entry.querySelector('.experiencia-aÃ±oFin').value,
                                actualidad: entry.querySelector('.experiencia-actualidad').checked
                            }));

                            const certificaciones = Array.from(document.querySelectorAll('.certificacion-entry')).map(entry => ({
                                nombre: entry.querySelector('.certificacion-nombre').value.trim(),
                                institucion: entry.querySelector('.certificacion-institucion').value.trim(),
                                aÃ±o: entry.querySelector('.certificacion-aÃ±o').value
                            }));

                            try {
                                const docRef = doc(db, "psicologos", psicologoId);
                                await setDoc(docRef, {
                                    id: psicologoId,
                                    nombre,
                                    apellido,
                                    documento,
                                    pais,
                                    correoElectronico,
                                    telefono,
                                    aÃ±osExperiencia,
                                    idiomas,
                                    precioServicioHora,
                                    descripcion,
                                    fechaNacimiento,
                                    experiencia,
                                    certificaciones,
                                    tiposTerapia,
                                    fotoPerfil: fotoPerfilUrl,
                                    redesSociales: {
                                        instagram,
                                        facebook,
                                        linkedin,
                                        tiktok
                                    }
                                });

                                mostrarBienvenida(nombre, apellido);

                            } catch (error) {
                                console.error("Error al registrar en Firestore: ", error);
                                alert("Hubo un error al guardar tus datos. Por favor, intenta de nuevo.");
                            }
                        }
                    );
                } catch (error) {
                    console.error("Error al registrar en Auth: ", error.message);
                    alert("Hubo un error al crear tu cuenta. Por favor, verifica tus datos e intenta de nuevo.");
                }
            });

            function mostrarBienvenida(nombre, apellido) {
                const overlay = document.getElementById('bienvenida-overlay');
                const mensaje = document.getElementById('mensaje-bienvenida');
                mensaje.textContent = `Â¡Bienvenid@ ${nombre} ${apellido} a PsyConnects!`;
                overlay.classList.add('mostrar');

                setTimeout(() => {
                    window.location.href = "../../psicologos.html";
                }, 7000);

                overlay.addEventListener('click', () => {
                    window.location.href = "../../psicologos.html";
                }, { once: true });
            }

            const subirArchivo = document.querySelector('.subir-archivo input[type="file"]');
            const placeholderArchivo = document.querySelector('.placeholder-archivo');

            if (subirArchivo && placeholderArchivo) {
                subirArchivo.addEventListener('change', () => {
                    placeholderArchivo.textContent = subirArchivo.files.length > 0 ? subirArchivo.files[0].name : 'Selecciona una imagen';
                });
            }

            document.querySelector('.menu-toggle').addEventListener('click', () => {
                document.querySelector('.nav-menu').classList.add('active');
            });

            document.querySelector('.close-menu').addEventListener('click', () => {
                document.querySelector('.nav-menu').classList.remove('active');
            });

            const formulario = document.getElementById('formularioRegistro');
            const pasosFormulario = document.querySelectorAll('.paso-formulario');
            const pasosBarra = document.querySelectorAll('.barra-progreso .paso');
            const botonesSiguiente = document.querySelectorAll('.boton-siguiente');
            const botonesAnterior = document.querySelectorAll('.boton-anterior');

            let pasoActual = 0;

            botonesSiguiente.forEach(boton => {
                boton.addEventListener('click', () => {
                    if (validarPaso(pasoActual)) {
                        pasosFormulario[pasoActual].classList.remove('activo');
                        pasosBarra[pasoActual].classList.remove('activo');
                        pasoActual++;
                        pasosFormulario[pasoActual].classList.add('activo');
                        pasosBarra[pasoActual].classList.add('activo');
                        actualizarBarraProgreso();
                    }
                });
            });

            botonesAnterior.forEach(boton => {
                boton.addEventListener('click', () => {
                    pasosFormulario[pasoActual].classList.remove('activo');
                    pasosBarra[pasoActual].classList.remove('activo');
                    pasoActual--;
                    pasosFormulario[pasoActual].classList.add('activo');
                    pasosBarra[pasoActual].classList.add('activo');
                    actualizarBarraProgreso();
                });
            });

            function validarPaso(paso) {
                let valido = true;
                const campos = pasosFormulario[paso].querySelectorAll('input, select, textarea');
                campos.forEach(campo => {
                    if (campo.type !== 'button' && !campo.checkValidity()) {
                        campo.reportValidity();
                        valido = false;
                    }
                });
                return valido;
            }

            function actualizarBarraProgreso() {
                pasosBarra.forEach((paso, indice) => {
                    paso.classList.toggle('activo', indice <= pasoActual);
                });
            }

            document.getElementById('toggle-contraseÃ±a').addEventListener('click', function () {
                const passwordInput = document.getElementById('contraseÃ±a');
                const isPasswordVisible = passwordInput.type === 'text';
                passwordInput.type = isPasswordVisible ? 'password' : 'text';
                this.textContent = isPasswordVisible ? 'ğŸ‘ï¸' : 'ğŸ™ˆ';
            });
        });

    </script>

</body>

</html>